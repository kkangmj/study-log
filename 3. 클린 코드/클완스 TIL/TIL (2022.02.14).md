# **TIL (2022.02.14)**

## DAY 1

🎇 오늘 읽은 범위: (8장) 경계

```
😀 책에서 기억하고 싶은 내용을 써보세요
```

- **외부 코드 사용하기**

  ```
  // java.util.Map이 제공하는 메서드

  clear() void - Map
  containsKey(Object key) boolean - Map
  containsValue(Object value) boolean - Map
  entrySet() Set - Map
  get(Object key) Object - Map
  ...
  ```

  ```
  // Bad Practice

  Map<String, Sensor> sensors = new HashMap<Sensor>();
  ...
  Sensor s = sensors.get(sensorId);
  ```

  - Map<String, Sensor>가 사용자에게 필요하지 않은 기능까지 제공한다는 문제가 있음.
  - 또한, 프로그램에서 Map<String, Sensor> 인스턴스를 여기저기로 넘긴다면, Map 인터페이스가 변할 경우, 수정할 코드가 많아짐.

  <br>

  ```
  // Good Practice

  public class Sensors {
      private Map sensors = new HashMap();

      public Sensor getById(String id) {
          return (Sensor) sensors.get(id);
      }
      ...
  }
  ```

  - 경계 인터페이스인 Map을 Sensors 안으로 숨김. 따라서 Map 인터페이스가 변하더라도 나머지 프로그램에는 영향을 미치지 않음.
  - 또한, Sensors 클래스는 프로그램에 필요한 인터페이스만 제공함.

  <br>

  > Map 인터페이스를 사용할 때마다 캡슐화하라는 것이 아니다. Map을(혹은 유사한 경계 인터페이스를) 여기저기 넘기지 말라는 말이다.

  > Map과 같은 경계 인터페이스를 이용할 때는 이를 이용하는 클래스나 클래스 계열 밖으로 노출하지 않도록 주의한다. Map 인스턴스를 공개 API의 인수로 넘기거나 반환값으로 사용하지 않도록 한다.

<br>

- **경계 살피고 익히기**
  - 우리쪽 코드를 작성해 외부 코드(라이브러리)가 예상대로 동작하는지 확인하는 대신 먼저 간단한 테스트 케이스를 작성해 외부 코드를 익혀라.
    <br>➡️ 학습 테스트

<br>

- **log4j 익히기**
  - 아파치의 log4j 패키지를 사용하려고 할 때에도 우리쪽 코드에 바로 도입하는 것이 아닌 테스트 케이스를 작성하며 익혀라.
  - log4j에 대한 학습 테스트 후 독자적인 로그 클래스로 캡슐화한다. 그러면 나머지 프로그램은 log4j 경계 인터페이스를 몰라도 된다.

<br>

- **학습 테스트는 공짜 이상이다**
  - 패키지 새 버전이 나온다면 학습 테스트를 돌려 차이가 있는지 확인한다. 새 버전이 우리 코드와 호환되지 않으면 학습 테스트가 이 사실을 곧바로 밝혀낸다.

<br>

- **경계**
  - 소프트웨어 설계가 우수하다면 변경하는데 많은 투자와 재작업이 필요하지 않다.
  - 경계에 위치하는 코드는 깔끔히 분리한다. 또한, 기대치를 정의하는 테스트 케이스도 작성한다. 이쪽 코드에서 외부 패키지를 세세하게 알아야 할 필요가 없다. 통제가 불가능한 외부 패키지에 의존하는 대신 통제가 가능한 우리 코드에 의존하는 편이 훨씬 좋다.
    <br>➡️ Map에서 봤듯이, 새로운 클래스로 경계를 감싸거나 아니면 ADAPTER 패턴을 사용해 우리가 원하는 인터페이스를 패키지가 제공하는 인터페이스로 변환하자.

<br>

```
🤔 오늘 읽은 소감은? 떠오르는 생각을 가볍게 적어보세요
```

- Map 예제는 7장 오류 처리에서 공부한 내용 중 하나인 감싸기 기법과 어느 정도 맞닿은 내용인 것 같다. 물론 7장에서의 감싸기 기법은 에러 핸들링에 초점이 맞춰져 있으나 "캡슐화"와 "의존성" 측면에서는 이번 장과 내용이 어느 정도 일맥상통한다고 생각한다.
- 외부 코드에 대한 테스트는 생각치도 못한 부분이었다. 학습 테스트를 통해 얻을 수 있는 이점이 충분하기 때문에 추후 외부 라이브러리 도입 시 이 내용을 적용해봐야겠다.

  <br>

```
🔍 궁금한 내용이 있거나, 잘 이해되지 않는 내용이 있다면 적어보세요
```

- 없음
